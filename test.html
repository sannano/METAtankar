
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>METAtankar</title>

  <!-- stylesheet -->
  <link rel="stylesheet" type="text/css" href="metatankar.css">
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />

  <!-- start icon, statusbar och mobilanpassning -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" sizes="144x144" href="meta.png">

  <link href="heaven.png" media="(device-width: 320px)and(device-height: 568px)and(-webkit-device-pixel-ratio: 2)"
        rel="apple-touch-startup-image">

  <!-- JQuery libraries -->
  <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
  <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>

  <!-- Include the jQuery Mobile library -->
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

  <!-- Include google jsapi -->
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>

  <!-- Bootstrap libraries -->
  <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
  <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">

  <!-- Pubnub libraries -->
  <script src='http://cdn.pubnub.com/pubnub-3.4.min.js'></script>

  <!-- Pubnub credentials -->
  <script src='cred.js'></script>

  <script>



    $(function() {

      // Grab the elements
      var username =$("#username");
      var input1 = $("#input1");
      var sendbutton1 = $("#sendbutton1");
      var output1 = $("#output1");
      var input2 = $("#input2");
      var sendbutton2 = $("#sendbutton2");
      var output2 = $("#output2");
      var impobtn = $("#important");
      var spambtn = $("#spam");

      var hello = $("#hello");
      var hello1 = $("#hello1");

      // Init PubNub
      var pubnub = PUBNUB.init({
        publish_key   : "pub-c-c28df6e6-db95-4fbb-9dec-e9c158810787",
        subscribe_key : "sub-c-d6fc11ce-ea76-11e4-85d8-02ee2ddab7fe"
      });

      
      //Get the username, from input 
      var getUsername = function() {
        var user = username.val();
        return user;
      }


//-------- VIKTIGA CHATRUMMET ---------//
      // receive messages 
      impobtn.on('click', function() {
        var me = getUsername();
        pubnub.subscribe({
          'channel'   : 'impo',
          'callback'  : function(message) {
            output1.html(output1.html() + '<br />' + message);
          }
        });
        
        str = "<h3>Hej "+ me +" välkommen till den viktiga chatten</h3>";
        hello.html(str);
      });

      // send messages 
      sendbutton1.on('click', function() {
        var me = getUsername();
        pubnub.publish({
          'channel' : 'impo',
          'message' : me+": "+input1.val()
        });
      });

     pubnub.bind( 'keyup', input1, function(e) {
       if ((e.keyCode || e.charCode) !== 13) return;
       send(input1.value);
       input1.value = '';
    });

//--------- SPAM CHATRUMMET ---------------//

      // receive messages 
      spambtn.on('click', function() {
        pubnub.subscribe({
          'channel'   : 'spam',
          'callback'  : function(message) {
            output2.html(output2.html() + '<br />' + message);
          }
        });
        str = "<h3>Hej "+ me +" välkommen till spamchatten</h3>";
        hello1.html(str);
      });

      // send messages 
      sendbutton2.on('click', function() {
        var me = getUsername();
        pubnub.publish({
          'channel' : 'spam',
          'message' : me+": "+input2.val()
        });
      });

    }); // $(function() {
  </script>
</head>

<body>

<!--/// Start du är i META ///-->

<div data-role="page" id="page-one" data-theme='f'>
    <div data-role="header" data-theme='f'>
        <h1>METAtankar</h1>
    </div>

    <div data-role="main" class="ui-content" data-theme='f'>
      <div id="info">
       <div id="infobox">
        <h5>Du är nu i META! Välj ett chatnamn och dela med dig av dina tankar. </h5>
      </div>
      <div> 
        <input class="input" type="text" placeholder="Välj ett namn" id="username">
      </div>  

        <!-- Knapparna -->
      
            <div id="left" style="margin-top:50px"><a href="#page-two" class="btn1" id="important">VIKTIGT!</a></div>  
            <div id="right" style="margin-top:50px"><a href="#page-three" class="btn1" id="spam">SPAM</a></div>
      
      </div>
    </div>


    <div data-role="footer" data-position="fixed" datatheme='f'>
      <p> &copy;2015 SESE Projekgrupp DM2518</p> 

    </div>
</div>

<!-- //// STOP du är i META //// -->


<!--/// VIKTIGT chatrum ///-->

<div data-role="page" id="page-two" data-theme='f'>
    <div data-role="header" data-theme='f'>
        <h1>VIKTIGT!</h1>
        <a href="#page-one" style="margin-top:38px" class="btnback">&#9668; Tillbaka </a>
    </div>

    <div data-role="main" class="ui-content" data-theme='f'>
      <div class="container">
        
        <div id="hello"></div>
        <input class="input-block-level" type="text" placeholder="Enter chat here" id="input1">
        <button id="sendbutton1" class="btn">Skicka</button>
        <div id="output1" style="margin-top:10px"></div>
      </div>
    </div>
</div>

<!--/// STOP VIKTIGT chatrum ///-->

<!--/// SPAM chatrum ///-->

<div data-role="page" id="page-three" data-theme='f'>
    <div data-role="header" data-theme='f'>
        <h1>SPAM!</h1>
        <a href="#page-one" style="margin-top:38px" class="btnback">&#9668; Tillbaka </a>
    </div>

    <div data-role="main" class="ui-content" data-theme='f'>
      <div class="container">
        <div id="hello1"></div>
        <input class="input-block-level" type="text" placeholder="Enter chat here" id="input2">
        <button id="sendbutton2" class="btn">Skicka</button>
        <div id="output2" style="margin-top:10px"></div>
      </div>
    </div>
</div>

<!--/// STOP SPAM chatrum ///-->


</body>
</html>